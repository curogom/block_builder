# 블록 쌓기 게임 개발 작업 문서 (Web 우선)

## 개요
- 목적: README 스펙 기반으로 Web 우선(Flutter 3.22 + Flame 1.x) 블록 쌓기 게임의 공수/난이도 평가와 실행 계획 정리.
- 현재 상태: 기본 Flutter 템플릿만 존재(`lib/main.dart`), Flame/오디오/상태관리 미연동, 자산/게임 폴더 구조 없음.

## 범위/스코프
- 코어 루프: 좌우 이동 → 탭 드랍 → 겹친 면적만 유지(트리밍) → 0이면 게임오버.
- 게임 시스템: 3분 타이머, 점수(높이/정밀/콤보), 난이도 곡선(속도 증가, 랜덤 오프셋).
- 화면/연출: 타이머/점수 UI, 카메라 상단 추적, 파편/보너스 이펙트, 간단 패럴랙스.
- 상태 전이: Boot → MainMenu → Playing ↔ Paused → GameOver.
- 플랫폼: Web 빌드 및 정적 호스팅(저장/네트워크/백엔드 없음).

## 가정/비범위
- 비범위: 계정/저장/랭킹/분석 SDK, 서버 연동, 모바일 스토어 출시 준비.
- 아트: 프로그래매틱(단색/그라디언트) 우선, 외부 이미지 최소화.
- 오디오: 기본 SE만, 라이선스 이슈 없는 프리 자산 또는 임시 톤.

## 아키텍처/모듈
- 게임 루프: `StackGame`(타이머/점수/상태/카메라), `Block`(이동/낙하/크기), `StackManager`(리스트/트리밍/높이), `UiOverlay`(HUD), `Effects`(파티클/피드백).
- 상태관리: 경량(`ValueNotifier`) 또는 `Riverpod` 중 택1. MVP는 경량 → 폴리싱 단계서 필요 시 Riverpod.
- 물리: AABB 기반 수평 오버랩 계산 + 도메인 트리밍 로직(수직 정렬 전제).

## 마일스톤
1) MVP: 이동/드랍, 트리밍, 타이머/게임오버, 카메라, 최소 HUD.
2) 폴리싱: 콤보/정밀 보너스, 파편/보너스 팝업, 난이도 곡선, 패럴랙스/피드백.
3) 제품화(웹): 튜토리얼/도움말, 파비콘/메타/OG, 빌드/배포 스크립트, 브라우저 호환 점검.

## 작업 내역 상세
- 프로젝트 세팅: Flame/Audio/상태관리 의존성 추가, `lib/game/*` 디렉토리, `assets/` 구조, 웹 렌더러(CanvasKit) 설정.
- 코어 구현: 이동 블록 스폰/왕복, 탭 드랍, 착지 이벤트, 트리밍 알고리즘, 스택/높이 갱신.
- UI/HUD: 타이머(180→0), 점수/콤보 표시, 경고(30초).
- 카메라: 스택 상단 추적, 상단 마진 유지.
- 이펙트/오디오: 파편 파티클, 정밀 드랍 피드백, 타임 경고/게임오버 SE.
- 난이도: 수평 속도 2%/층 증가(상한 380px/s), 미세 랜덤 오프셋 이벤트.
- 상태/오버레이: 메뉴/일시정지/게임오버 오버레이.
- 제품화: 튜토리얼 힌트, 파비콘/메타/OG 이미지, `make build-web` 또는 `dart run` 스크립트, 배포 가이드.

## 공수 추정(1명, 순수 개발 기준)
- 프로젝트 세팅: 0.5–1.0일
- 코어 루프+트리밍+스택: 1.5–2.0일
- 타이머/게임오버/HUD: 0.5–1.0일
- 카메라 추적/기본 연출: 0.5일
- 폴리싱(콤보/보너스/이펙트/난이도): 2.0–3.0일
- 오디오 통합(트리거/레벨링): 0.5일
- 웹 제품화(튜토리얼/메타/빌드/배포): 1.5–2.0일
- 테스트/튜닝(QA, 브라우저 점검): 1.0일
- 버퍼(리스크/호환성): 15–20%
- 합계: 약 7.0–10.0일 + 버퍼(≈1–2일) → 총 8–12일

## 난이도 평가
- 트리밍 정확도/파편 연출: 중간(알고리즘 간단하나 시각적/감각적 품질 요구)
- 카메라/스택 성능: 낮음–중간(엔티티 수 관리/배경 최적화 필요)
- 콤보/정밀 판정/피드백: 중간(판정/연출/점수 연동)
- 웹 제품화/호환성: 낮음–중간(정적 호스팅/메타, 브라우저 테스트)

## 리스크/대응
- Flame/Flutter 버전 호환: flame 1.x와 Flutter 3.22 조합 확인 → 버전 고정/샘플 빌드 선검증.
- 모바일 웹 퍼포먼스: 파티클 수/드로우콜 제어, CanvasKit 선택, 저사양 모드 제공.
- 오디오 정책: 사용자 제스처 이후 재생, 초기 mute/토글 제공.
- 입력/레이아웃 반응형: 화면비 대응 HUD/터치 타겟 검증.

## 의존성/세팅
- 패키지: `flame`, `flame_audio`, `riverpod` 또는 `flutter_riverpod`(선택), 필요 시 `flame_riverpod`.
- 에셋: SE 폴더/라이선스 명확화, 프로그램적 그래픽 우선.
- 웹 설정: `--web-renderer canvaskit`, viewport/meta/OG in `web/index.html`.

## 테스트 계획
- 단위: 트리밍(AABB 오버랩=0 즉시 게임오버/경계값) 로직 테스트.
- 통합: 속도 상한/난이도 곡선/타이머 경고/콤보 연동 시나리오.
- 수동 QA: 브라우저(Chrome/Edge/Safari) 및 모바일 웹 입력/레이턴시.

## 릴리스 체크리스트(웹)
- 빌드: `flutter build web --web-renderer canvaskit`
- 정적 호스팅: GitHub Pages/Cloudflare/Firebase 중 택1
- 메타: 파비콘/OG 이미지/제목·설명, 간단 소개 페이지 스크린샷

## 타임라인 안
- 집중 2주: 1인 풀타임 → 8–12일 범위 내 완료(버퍼 포함)
- 완급 조절: 1주 내 MVP(3–5일) + 1주 폴리싱/제품화

## 인력/역할
- 게임 클라이언트 1명: Flutter/Flame, 애니/오디오 트리거, 빌드/배포
- QA 보조(파트타임): 브라우저/디바이스 체크 0.5–1일

## 오픈 이슈(결정 필요)
- 상태관리 전략: MVP는 경량(ValueNotifier) vs 초기부터 Riverpod 도입
- 스코어 공식: 정밀 보너스/콤보 배율 구체 수치
- 패럴랙스 레이어 수/강도, 파편 이펙트 밀도 상한
- 웹 렌더러 기본값(CanvasKit) 합의 및 저사양 옵션

## 즉시 다음 단계
- 의존성/폴더 스캐폴드 추가(flame/audio, `lib/game/*`, `assets/`)
- MVP 기능(이동/드랍/트리밍/타이머/게임오버) 구현
- 샘플 웹 빌드로 성능/호환성 스모크 테스트

